<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>CloudDeakin Dual Delivery Template</title>
<link rel="stylesheet" type="text/css" href="/content/enforced/384049-SEBE_LST_01/z-intmedia-donotedit/templates/sebe-fl.css">
<link rel="stylesheet" type="text/css" href="/content/enforced/384049-SEBE_LST_01/z-intmedia-donotedit/templates/open-source-css-and-js/prism/prism.css">
<link rel="stylesheet" type="text/css" href="/content/enforced/384049-SEBE_LST_01/z-intmedia-donotedit/templates/open-source-css-and-js/prism/prism.overrides.css">
</head><body class="cloudFirst"><p><img src="../images/Fitting%20a%20regression%20line%20image%201.jpg" alt="Ceiling light fixtures in a modern building" title="Ceiling light fixtures in a modern building" style="max-width: 100%;" data-d2l-editor-default-img-style="true"></p>
<address><a href="https://www.gettyimages.com.au" target="_blank" rel="noopener noreferrer">© Getty Images</a></address>
<div>
<h1>Fitting a regression line</h1>
</div>
<div>
<p>A simple regression line takes the form:&nbsp;<math title="" xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><semantics><mstyle><mi>y</mi><mo>=</mo><msub><mi>w</mi><mi>o</mi></msub><mo>+</mo><msub><mi>w</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub></mstyle><annotation encoding="latex">{"version":"1.1","math":"\(y=w_o+w_1x_1\)"}</annotation></semantics></math></p>
<p>The closed form solution is:&nbsp;<math title="" xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><semantics><mstyle><mi>W</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msup><mi>X</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>−<!-- − --></mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msup><mi>y</mi></mstyle><annotation encoding="latex">{"version":"1.1","math":"\(W=(X^{T}X)^{-1}X^{T}y\)"}</annotation></semantics></math></p>
<p>Where W= [<math title="" xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><semantics><mstyle><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></mstyle><annotation encoding="latex">{"version":"1.1","math":"\(w_{o}, w_{1}\)"}</annotation></semantics></math>], X=[<math title="" xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><semantics><mstyle><mn>1</mn><mo>,</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></mstyle><annotation encoding="latex">{"version":"1.1","math":"\(1,x_{1}\)"}</annotation></semantics></math>]</p>
<p>Let’s extend the code we started previously to fit a regression line.</p>
<h4 id="code-example-1">Code example #1</h4>
<p>We’ll calculate the value of&nbsp;<math title="" xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><semantics><mstyle><mi>y</mi></mstyle><annotation encoding="latex">{"version":"1.1","math":"\(y\)"}</annotation></semantics></math>&nbsp;where&nbsp;<math title="" xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><semantics><mstyle><mi>x</mi><mo>=</mo><mn>0</mn></mstyle><annotation encoding="latex">{"version":"1.1","math":"\(x = 0\)"}</annotation></semantics></math>&nbsp;</p>
<p>and set the intercept value. If you’d like to know more about constants check out this article on <a href="https://blog.minitab.com/blog/adventures-in-statistics-2/regression-analysis-how-to-interpret-the-constant-y-intercept" target="_blank" rel="noopener noreferrer">Y intercepts</a>.</p>
<pre class="line-numbers d2l-code"><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# use the correct path to where you saved the foodtruck data file
data = pd.read_csv('data/foodtruck_profits.txt', delimiter=',', header=None).values
print("Data shape: {}".format(data.shape))
print('The first few lines of data: {}'.format(data[0:5,:]))
</code></pre>
<h2><strong>The output would look like this:</strong></h2>
<p>Data shape: (100, 2)<br>The first few lines of data: [[ 6.1101 17.592 ]<br>&nbsp;[ 5.5277 &nbsp;9.1302]<br>&nbsp;[ 8.5186 13.662 ]<br>&nbsp;[ 7.0032 11.854 ]<br>&nbsp;[ 5.8598 &nbsp;6.8233]]</p>
<pre class="line-numbers d2l-code"><code class="language-python"># add a variable and find the length of the data
m = len(data)

# we change the one-dimensional data into a matrix form 
X = np.matrix(data[:,0]).T
y = np.matrix(data[:,1]).T

print("Number of examples: {}".format(m))
print("Shape of data     : {}".format(X.shape))
print("Shape of labels   : {}".format(y.shape))</code></pre>
<p>The output would look like this:</p>
<div>
<div>
<pre><code>Number of examples: 100
Shape of data     : (100, 1)
Shape of labels   : (100, 1)</code></pre>
</div>
</div>
<p></p>
<div>
<div>
<pre><code class="language-Python">
# add intercept term to data X
X = np.c_[np.ones(m), X] #np.c_ helps in appending columns

print("New shape of data: {}".format(X.shape))

</code></pre>
</div>
</div>
<p>The output would look like this:</p>
<div>
<div>
<pre><code class="language-Python">New shape of data: (100, 2)
</code></pre>
</div>
</div>
<h4 id="code-example-2">Code example #2</h4>
<div>
<div>
<pre><code class="language-Python">
# Closed form solution

#Compute inverse of (Xtranspose * X)
temp1 = np.linalg.pinv(np.dot(X.T,X))

#Computer Xtranspose * y
temp2 = np.dot(X.T,y)

W = np.dot(temp1,temp2)
print (W.shape)

print (W)

</code></pre>
</div>
</div>
<p>The output would look like this:</p>
<div>
<div>
<pre><code class="language-Python">(2, 1)
[[-3.95911545]
 [ 1.19673809]]
</code></pre>
</div>
</div>
<h4 id="code-example-3">Code example #3</h4>
<div>
<div>
<pre><code class="language-Python">plt.scatter(data[:,0],data[:,1], color="red", marker="x",)
plt.plot(X[:,1], np.dot(X,W)) #regression line

plt.xlabel('Population of City in 10,000s')
plt.ylabel('Profit in 10,000s')

</code></pre>
</div>
</div>
<p>The output would look like this:</p>
<div>
<div>
<pre><code class="language-Python">Text(0,0.5,'Profit in 10,000s')
</code></pre>
</div>
</div>
<p class="centerImage"><img src="../images/Fitting%20a%20regression%20line%20image%202.png" alt="" title="" style="max-width: 100%;" data-d2l-editor-default-img-style="true"></p>
<h4 id="code-example-4">Code example #4</h4>
<p>We can use this fitted regression model to predict profit for population of size 175,000. Population in&nbsp;<math title="" xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><semantics><mstyle><mn>10000</mn></mstyle><annotation encoding="latex">{"version":"1.1","math":"\(10000\)"}</annotation></semantics></math>&nbsp;is&nbsp;<math title="" xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><semantics><mstyle><mn>17.5</mn></mstyle><annotation encoding="latex">{"version":"1.1","math":"\(17.5\)"}</annotation></semantics></math>.</p>
<p>Note that we have to add the intercept term to this.</p>
<div>
<div>
<pre><code class="language-Python"># 17.5 x 10,000 = 175,000 population so we use x = 17.5
predicted_profit = np.dot([1,17.5], W)
# Predicted profit needs to be multiplied by y units, 10,000, and rounded to be currency
print ("Start by finding the y value at x = 17.5: {}".format(predicted_profit))
# multiply by 10,000 because that's the y unit
multiplied_profit = predicted_profit * 10000           
# round to two decimal places so it looks like money
final_profit = np.around(multiplied_profit, decimals = 2)
print ("For a population of 175,000, we predict a profit of: {}".format(final_profit))

</code></pre>
</div>
</div>
<p>The output would look like this:</p>
<div>
<div>
<pre><code class="language-Python">Start by finding the y value at x = 17.5: [[16.98380112]]
For a population of 175,000, we predict a profit of: [[169838.01]]
</code></pre>
</div>
</div>
<p>In the next lesson we will look at a multivariate example.</p>
<h2 id="your-task">Activity</h2>
<p>Make sure that you have experimented with all the individual Python coding examples that we have in this lesson, and that you are confident about how they work.</p>
<p>Discuss any issues or questions in the <a href="/d2l/common/dialogs/quickLink/quickLink.d2l?ou=1734011&amp;type=discuss&amp;rcode=DeakinUniversity-2000313" target="_top">discussion forum</a>. See if you can help someone else.</p>
<p>Save your work before moving on.</p>
<p></p>
</div>
<hr>
<div style="padding-top: 20px;"><a href="#" class="navrep-button" target="_parent" title="Previous" style="padding: .5rem .5rem; font-size: 12pt; float: left;"> &lt; Previous</a> <a href="#" class="navrep-button" target="_parent" title="Next" style="padding: .5rem .5rem; font-size: 12pt; float: right;">Next &gt;</a></div>
<p style="padding-bottom: 50px;"></p>
<p>
<script defer="defer" type="text/javascript" src="/content/enforced/384049-SEBE_LST_01/z-intmedia-donotedit/templates/sebe-master.js"></script>
<script type="text/javascript" src="/content/enforced/384049-SEBE_LST_01/z-intmedia-donotedit/templates/open-source-css-and-js/prism/prism.js"></script>
</p>
<p>
<script>
function localProc(){

  console.log("");
  console.log("ready!");

 
}
</script>
</p>
<p>
<script type="text/javascript" src="/content/enforced/384049-SEBE_LST_01/z-sebe-lst-learning-design/fl-dual-delivery/js/sebe-fl-prism.js"></script>
<script type="text/javascript" src="/content/enforced/384049-SEBE_LST_01/z-sebe-lst-learning-design/fl-dual-delivery/js/sebe-fl-mathjax.js"></script>
<script type="text/javascript" src="/content/enforced/384049-SEBE_LST_01/z-sebe-lst-learning-design/fl-dual-delivery/js/sebe-fl-nav.js"></script>
<script type="text/javascript" src="/content/enforced/384049-SEBE_LST_01/z-sebe-lst-learning-design/fl-dual-delivery/js/sebe-fl.js"></script>
</p></body></html>